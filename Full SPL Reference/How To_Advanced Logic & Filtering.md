### **II. How To: Advanced Logic & Filtering**

_Moving beyond basic `search index=main`._

#### **1. Using Arrays for "In" Logic**

The `IN` operator is the cleanest way to filter against a static list of values.

**Syntax:**

Code snippet

```
index=security EventType IN ("Tornado", "Flood", "Wildfire")
```

#### **2. Subsearches (The Dynamic "In" List)**

If you want to filter your main search based on a list generated by _another_ search (e.g., "Find all logs from users who failed a login 10 minutes ago"), use brackets `[]`.

**Syntax:**

Code snippet

```
index=firewall src_ip IN [ search index=security action=blocked | stats count by src_ip | fields src_ip ]
```

_This runs the inner search first, extracts the `src_ip` list, and formats it as `(ip1 OR ip2 OR ip3)` for the outer search._

#### **3. Conditional Bucketing (`if` / `case`)**

Create categories on the fly using `eval`.

**Syntax:**

Code snippet

```
| eval RiskLevel = case(
    Injuries > 50, "Critical",
    Injuries > 10, "High",
    Injuries > 0,  "Medium",
    true(),        "Low"
)
```
